import Link from "next/link";
import React, { useCallback, useState } from "react";
import ChooseColor from "../ChooseColor";
import axios from "axios";
import { useDispatch } from "react-redux";
import { SET_OUTPUT } from "../../reducers/code";

const Footer = ({ toggleColor, chooseTheme, show }: any) => {
  const [value, setValue] = useState("");
  const dispatch = useDispatch();
  const changeValue = useCallback(
    (e: any) => {
      setValue(e.target.value);
    },
    [value]
  );
  const onClickRuntime = useCallback(async () => {
    const res = await axios.post("http://kt-lang.tk:3080/run", {
      code: value,
    } as any);
    dispatch({
      type: SET_OUTPUT,
      data: res.data,
    });
  }, [value]);

  return (
    <footer>
      <textarea value={value} onChange={changeValue}></textarea>
      <div className="footer-footer">
        <div className="iconContainer">
          <Link href="https://github.com/ksh5324/KT1207lang">
            <a>
              <div className="icon">
                <svg
                  width="17"
                  height="17"
                  viewBox="0 0 17 17"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M13.4583 0H3.54167C1.58596 0 0 1.58596 0 3.54167V13.4583C0 15.414 1.58596 17 3.54167 17H13.4583C15.4148 17 17 15.414 17 13.4583V3.54167C17 1.58596 15.4148 0 13.4583 0ZM10.2949 13.8762C10.008 13.9315 9.91667 13.7551 9.91667 13.6042V12.0495C9.91667 11.5203 9.73108 11.1761 9.52708 11.0004C10.7893 10.8602 12.1153 10.3806 12.1153 8.20463C12.1153 7.58554 11.8943 7.07979 11.5324 6.68383C11.5905 6.54075 11.7845 5.96417 11.4764 5.18429C11.4764 5.18429 11.0011 5.032 9.9195 5.76512C9.46617 5.63762 8.98167 5.576 8.5 5.57317C8.01833 5.57529 7.53383 5.63762 7.08121 5.76371C5.99887 5.03058 5.52287 5.18287 5.52287 5.18287C5.21546 5.96346 5.40954 6.53933 5.46833 6.68313C5.10567 7.07979 4.88467 7.58483 4.88467 8.20392C4.88467 10.3742 6.20713 10.8609 7.46654 11.0047C7.30433 11.1463 7.15771 11.3957 7.10671 11.7626C6.783 11.9071 5.96346 12.1571 5.45771 11.2908C5.45771 11.2908 5.15808 10.7468 4.58858 10.7065C4.58858 10.7065 4.03608 10.6994 4.54962 11.0514C4.54962 11.0514 4.9215 11.2257 5.17933 11.8802C5.17933 11.8802 5.50729 12.8917 7.08333 12.5488V13.6035C7.08333 13.753 6.99196 13.9287 6.70933 13.8762C4.45683 13.1275 2.83333 11.0032 2.83333 8.5C2.83333 5.36987 5.37058 2.83333 8.5 2.83333C11.6294 2.83333 14.1667 5.36987 14.1667 8.5C14.1667 11.0025 12.5453 13.1261 10.2949 13.8762Z"
                    fill="#A4A4A4"
                  />
                </svg>
              </div>
            </a>
          </Link>
          <div className="icon" onClick={toggleColor}>
            <svg
              width="17"
              height="17"
              viewBox="0 0 17 17"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9.20837 0.708252C5.68725 0.708252 2.12504 1.65954 2.12504 2.83325V5.00996C1.36217 5.74308 0.708374 6.66109 0.708374 7.71509C0.708374 9.24934 2.07617 10.1078 3.65221 10.1078C5.01362 10.1078 6.69592 9.50646 8.40017 8.12025C8.24362 7.93467 8.14587 7.69879 8.14587 7.43742C8.14587 6.85021 8.62117 6.37492 9.20837 6.37492C9.79558 6.37492 10.2709 6.85021 10.2709 7.43742C10.2709 8.02463 9.79558 8.49992 9.20837 8.49992L9.066 8.48575C7.298 9.99096 5.40037 10.8155 3.6515 10.8162C3.09829 10.8162 2.58758 10.7227 2.12433 10.5576V13.6375C2.12504 15.0499 4.95837 16.2916 9.22892 16.2916C13.4364 16.2916 16.2917 15.0555 16.2917 13.6375V2.83325C16.2917 1.65954 12.7295 0.708252 9.20837 0.708252ZM2.12504 8.99292C1.06396 8.30442 1.26796 7.11513 2.12504 6.05688V8.99292ZM14.1667 13.9456C13.8175 14.1737 13.1665 14.367 12.75 14.3663V5.33438C13.1538 5.31525 13.7877 5.18704 14.1667 5.04679V13.9456ZM9.26362 4.09479C7.80942 4.09479 3.95892 3.81854 3.95892 3.1095C3.95892 2.39338 7.49067 2.00663 9.26362 2.00663C11.0826 2.00663 14.5839 2.40117 14.5839 3.1095C14.5839 3.82563 10.7518 4.09479 9.26362 4.09479Z"
                fill="#A4A4A4"
              />
            </svg>
          </div>
        </div>
        {show ? (
          <ChooseColor chooseTheme={chooseTheme} not={false} />
        ) : (
          <ChooseColor chooseTheme={chooseTheme} not={true} />
        )}
        <button onClick={onClickRuntime}>실행</button>
      </div>
    </footer>
  );
};

export default Footer;
